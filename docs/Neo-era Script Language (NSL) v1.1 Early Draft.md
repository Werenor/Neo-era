# Neo-era Script Language (NSL) v1.2 Draft Specification  
**æ›´æ–°æ—¥æœŸï¼š2025-11-10**  
**é€‚ç”¨å¼•æ“Žç‰ˆæœ¬ï¼šNeo-era Core 0.12+**

---

## ðŸ§­ æ¦‚è¿°ï¼ˆOverviewï¼‰

**NSLï¼ˆNeo-era Script Languageï¼‰** æ˜¯ Neo-era å¼•æ“Žçš„è„šæœ¬è¯­è¨€ï¼Œç”¨äºŽæè¿°å‰§æƒ…ã€æ¼”å‡ºä¸Žæ¸¸æˆé€»è¾‘ã€‚  
è„šæœ¬ç» `parser` è§£æžä¸º ASTï¼Œç”± `interpreter` æ‰§è¡Œå¹¶è°ƒç”¨ `renderer` å®žçŽ°è§†è§‰ä¸ŽéŸ³é¢‘è¡¨çŽ°ã€‚

æœ¬è§„èŒƒå¯¹åº” Neo-era v0.12 å®žè£…ç‰ˆæœ¬ï¼Œè¦†ç›–çŽ‡çº¦ 70%ã€‚  
å‰©ä½™è¯­æ³•å°†åœ¨åŽç»­ v1.3 ä¸­è¡¥å…¨ã€‚

---

## ðŸ§© ä¸€ã€åŸºç¡€è¯­æ³•è§„åˆ™

| é¡¹ç›® | æè¿° |
|------|------|
| æ³¨é‡Š | ä½¿ç”¨ `#` å¼€å¤´ï¼›æ•´è¡Œè¢«å¿½ç•¥ |
| ç©ºç™½è¡Œ | è‡ªåŠ¨è·³è¿‡ |
| åŒºåˆ†å¤§å°å†™ | æŒ‡ä»¤ä¸Žå˜é‡åä¸åŒºåˆ†å¤§å°å†™ |
| å­—ç¬¦ä¸² | ä½¿ç”¨åŒå¼•å·æˆ–å•å¼•å·å‡å¯ |
| å ä½ç¬¦æ›¿æ¢ | `{å˜é‡å}` åœ¨æ‰§è¡Œæ—¶ä¼šè¢«ä¸Šä¸‹æ–‡å€¼æ›¿æ¢ |
| æŒ‡ä»¤åˆ«å | æ”¯æŒåŒä¹‰å†™æ³•ï¼Œå¦‚ `show_sprite` â‰¡ `sprite_show`ï¼ˆalias ä½“ç³»ï¼‰ |
| å®½å®¹æ€§ | æœªçŸ¥æŒ‡ä»¤ä»…è­¦å‘Šï¼Œä¸ä¸­æ–­è„šæœ¬æ‰§è¡Œ |

---

## ðŸ’¬ äºŒã€æ–‡æœ¬ä¸ŽæŽ§åˆ¶æµ

| åŠŸèƒ½ | è¯­æ³• | çŠ¶æ€ | è¯´æ˜Ž |
|------|-------|--------|------|
| è¾“å‡ºæ–‡æœ¬ | `"å°è¯æ–‡æœ¬"`ï¼ˆéšå¼ echoï¼‰ | âœ… | è‡ªåŠ¨æ˜¾ç¤ºå¹¶ç­‰å¾…ç‚¹å‡» |
| æ˜¾å¼è¾“å‡º | `echo "æ–‡æœ¬"` / `say "æ–‡æœ¬"` | âœ… | ä¸Žéšå¼ echo ç­‰ä»· |
| å˜é‡è®¾ç½® | `set name = expr` | âœ… | å¯å­˜å…¥å­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°” |
| æ¡ä»¶åˆ¤æ–­ | `if cond: ... else: ...` | âœ… | æ”¯æŒåµŒå¥— |
| é€‰æ‹©åˆ†æ”¯ | `choice "A", "B", "C"` | âœ… | ç”¨æˆ·é€‰æ‹©ï¼Œç»“æžœå†™å…¥å˜é‡ `choice` |
| å»¶æ—¶ | `delay N` | ðŸš§ | è®¡åˆ’ä¸­ï¼ˆè‡ªåŠ¨æ’­æ”¾èŠ‚å¥ï¼‰ |
| ç­‰å¾…ç‚¹å‡» | `wait` | âš ï¸ | é€»è¾‘å·²å†…ç½®åœ¨ echo ä¸­ |
| å¾ªçŽ¯ç»“æž„ | `for`, `while`, `break` | âŒ | æœªå®žçŽ°ï¼ˆè®¡åˆ’ä¸­ï¼‰ |

---

## ðŸ–¼ ä¸‰ã€èƒŒæ™¯ä¸ŽéŸ³é¢‘

| åŠŸèƒ½ | è¯­æ³• | çŠ¶æ€ | è¯´æ˜Ž |
|------|-------|--------|------|
| åˆ‡æ¢èƒŒæ™¯ | `bg path` | âœ… | ç«‹å³åˆ‡æ¢èƒŒæ™¯å›¾åƒ |
| èƒŒæ™¯æ·¡å…¥ | `bg path fade=30` | ðŸš§ | å‚æ•°è§£æžæœªå®žçŽ°ï¼ˆé»˜è®¤æ·¡å…¥20å¸§ï¼‰ |
| æ’­æ”¾BGM | `bgm path` | âœ… | å¾ªçŽ¯æ’­æ”¾ |
| åœæ­¢BGM | `stop_bgm` | âœ… | å«è‡ªåŠ¨æ·¡å‡º |
| æ’­æ”¾SE | `se path` | âŒ | æœªå®žçŽ°ï¼ˆå°†ä½œä¸ºéŸ³æ•ˆé€šé“æ‰©å±•ï¼‰ |

---

## ðŸ§â€â™€ï¸ å››ã€ç«‹ç»˜ç³»ç»Ÿï¼ˆSpritesï¼‰

| åŠŸèƒ½ | è¯­æ³• | çŠ¶æ€ | è¯´æ˜Ž |
|------|-------|--------|------|
| æ˜¾ç¤ºç«‹ç»˜ | `show_sprite path pos` | âœ… | æ”¯æŒ left / center / right |
| åŒä¹‰å½¢å¼ | `sprite_show path pos` | âš ï¸ | Alias ç³»ç»Ÿè§„åˆ’ä¸­ |
| è‡ªå®šä¹‰å‚æ•° | `show_sprite path x= y= scale= fade= layer=` | ðŸš§ | å‚æ•°æœªè§£æž |
| éšè—ç«‹ç»˜ | `hide_sprite path` | âœ… | æ­£å¸¸æ·¡å‡ºåŽåˆ é™¤ |
| å…¨éƒ¨éšè— | `hide_sprite all` | âœ… | æ¸…é™¤æ‰€æœ‰ç«‹ç»˜ï¼ˆæ–‡æ¡£æ–°å¢žï¼‰ |
| ç°åº¦/æš—åŒ– | `gray_sprite path` | âŒ | æœªå®žçŽ° |
| ç¿»è½¬/æ—‹è½¬ | `flip_sprite` / `rotate_sprite` | âŒ | æœªå®žçŽ° |
| åŠ¨ç”»ç§»åŠ¨ | `move_sprite path x= y= duration=` | âŒ | æœªå®žçŽ° |

---

## ðŸ§  äº”ã€å˜é‡ä¸Žä¸Šä¸‹æ–‡ç³»ç»Ÿ

| åŠŸèƒ½ | è¯­æ³• | çŠ¶æ€ | è¯´æ˜Ž |
|------|-------|--------|------|
| å˜é‡å£°æ˜Ž | `var name = value` | âŒ | `set` å·²æ¶µç›–åŠŸèƒ½ |
| æŒä¹…å˜é‡ | `pvar name = value` | ðŸš§ | runtime ä¿å­˜æœªæ•´åˆ |
| åˆ é™¤å˜é‡ | `del name` | âŒ | æœªå®žçŽ° |
| æ¸…ç©ºä¸Šä¸‹æ–‡ | `clear` | ðŸš§ | Context å†…å·²æœ‰ç»“æž„ |
| èŽ·å–å˜é‡ | `{name}` | âœ… | å ä½ç¬¦æ›¿æ¢å¯ç”¨ |
| å¸ƒå°”å˜é‡ | `setbool flag true` | âŒ | è®¡åˆ’åŠ å…¥å¸ƒå°”ä¸“ç”¨è§£æž |
| è¡¨è¾¾å¼æ”¯æŒ | `==, !=, >, <, +` | âš ï¸ | ç®€å•æ¯”è¾ƒå·²æ”¯æŒ |

---

## ðŸ’¾ å…­ã€å­˜æ¡£ä¸Žè¿è¡Œæ—¶

| åŠŸèƒ½ | è¯­æ³• | çŠ¶æ€ | è¯´æ˜Ž |
|------|-------|--------|------|
| ä¿å­˜ | `save slot` | ðŸš§ | runtime æœ‰æŽ¥å£æœªæŽ¥å…¥ |
| è¯»å– | `load slot` | ðŸš§ | åŒä¸Š |
| åˆ é™¤ | `delete slot` | âŒ | æœªå®žçŽ° |
| å¿«é€Ÿå­˜æ¡£ | `quicksave` | âŒ | æœªå®žçŽ° |

---

## ðŸŽ¨ ä¸ƒã€å¯¹è¯æ¡†ä¸ŽUIï¼ˆè§„åˆ’é˜¶æ®µï¼‰

| åŠŸèƒ½ | è¯­æ³• | çŠ¶æ€ | è¯´æ˜Ž |
|------|-------|--------|------|
| æ˜¾ç¤ºå¯¹è¯æ¡† | `dialogue show` | âŒ | è®¡åˆ’åŠ å…¥ UI å±‚ |
| éšè—å¯¹è¯æ¡† | `dialogue hide` | âŒ | è®¡åˆ’ä¸­ |
| æ»šåŠ¨æ”¯æŒ | è‡ªåŠ¨ | âŒ | è®¡åˆ’ä¸­ |
| UIæŒ‰é’® | `ui_button id x= y= text=` | âŒ | è®¡åˆ’ä¸­ |
| ç³»ç»Ÿèœå• | `config set key=value` | âŒ | è®¡åˆ’ä¸­ |

---

## âš™ï¸ å…«ã€ç³»ç»Ÿä¸Žè°ƒè¯•

| åŠŸèƒ½ | è¯­æ³• | çŠ¶æ€ | è¯´æ˜Ž |
|------|-------|--------|------|
| è¾“å‡ºå˜é‡ | `printvar name` | âŒ | è°ƒè¯•æŽ¥å£æœªå®žçŽ° |
| è·Ÿè¸ªæ¨¡å¼ | `trace` | âŒ | æœªå®žçŽ° |
| ç»“æŸæ‰§è¡Œ | `exit` | âœ… | æ”¯æŒç»ˆæ­¢è„šæœ¬çº¿ç¨‹ |
| å¯¼å…¥è„šæœ¬ | `import path` | âŒ | æœªå®žçŽ°ï¼ˆæ¨¡å—åŒ–é˜¶æ®µï¼‰ |

---

## ðŸ§¾ ä¹ã€è¡¥å……å®žçŽ°ç‰¹æ€§ï¼ˆæ–‡æ¡£æ–°å¢žï¼‰

| åŠŸèƒ½ | è¯­æ³• | çŠ¶æ€ | è¯´æ˜Ž |
|------|-------|--------|------|
| æ¸…ç©ºå…¨éƒ¨ç«‹ç»˜ | `hide_sprite all` | âœ… | æ–°å¢žå®˜æ–¹æ”¯æŒ |
| é»˜è®¤æ·¡å…¥ | `fade_frames=20` | âœ… | renderer é»˜è®¤å‚æ•° |
| è·¯å¾„è®¿é—®å˜é‡ | `ctx.set_path("a.b.c", 1)` | âœ… | æ”¯æŒå¤šå±‚å‘½åç©ºé—´ |
| æœªçŸ¥æŒ‡ä»¤å¤„ç† | è‡ªåŠ¨è­¦å‘Š | âœ… | ä¸ä¸­æ–­æ‰§è¡Œ |

---

## ðŸ“Š åã€å®žçŽ°è¦†ç›–çŽ‡ç»Ÿè®¡

| æ¨¡å— | è¦†ç›–çŽ‡ | è¯´æ˜Ž |
|------|-----------|------|
| æ ¸å¿ƒè¯­æ³•ï¼ˆæ–‡æœ¬ã€å˜é‡ã€åˆ†æ”¯ã€ç«‹ç»˜ã€èƒŒæ™¯ã€éŸ³ä¹ï¼‰ | **â‰ˆ70%** | å·²å®Œå…¨å¯ç”¨ |
| æŽ§åˆ¶é€»è¾‘ï¼ˆå¾ªçŽ¯ã€å¸ƒå°”ã€å»¶è¿Ÿï¼‰ | **â‰ˆ30%** | éœ€å®Œå–„ |
| ç³»ç»ŸåŠŸèƒ½ï¼ˆUIã€å­˜æ¡£ã€é…ç½®ï¼‰ | **â‰ˆ10%** | åˆæœŸæœªå®žçŽ° |

---

## ðŸ§± åä¸€ã€æœªæ¥æ‰©å±•ï¼ˆv1.3+ è§„åˆ’ï¼‰

- `delay` / `wait` â†’ å¼‚æ­¥é€»è¾‘  
- `show_sprite` å‚æ•°åŒ–ä½ç½®/ç¼©æ”¾/é€æ˜Žåº¦  
- `gray_sprite`, `flip_sprite`, `move_sprite` åŠ¨ç”»  
- `save/load` æ•´åˆ runtime  
- UI ç³»ç»Ÿï¼ˆæŒ‰é’®ã€å¯¹è¯æ¡†ã€ç³»ç»Ÿèœå•ï¼‰  
- `config` ä¸Žå¤–è§‚æŽ§åˆ¶  
- Debug Overlay ä¸Ž FPS ç›‘æŽ§  

---

## ðŸ§© é™„å½•ï¼šå¼•æ“Žæ‰§è¡Œæµç¨‹

```text
.script file
   â†“
 parser.py â†’ è¯æ³•è§£æžï¼Œç”Ÿæˆ AST
   â†“
 interpreter.py â†’ æ‰§è¡Œé€»è¾‘ï¼Œæ“ä½œ ctx å˜é‡ä¸Žæ¸²æŸ“å±‚
   â†“
 renderer_gui.py â†’ è¾“å‡ºå›¾åƒã€éŸ³ä¹ä¸Žäº¤äº’äº‹ä»¶
